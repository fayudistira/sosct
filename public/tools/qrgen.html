<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generator QR Code</title>
    <!-- Tailwind CSS untuk styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- QRCode.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap");

      body {
        font-family: "Inter", sans-serif;
        background-color: #f3f4f6;
      }

      /* Animasi halus untuk kemunculan QR Code */
      #qrcode img {
        margin: 0 auto;
        border-radius: 8px;
        box-shadow:
          0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
        animation: fadeIn 0.5s ease-in-out;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body
    class="min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-indigo-100 via-purple-100 to-pink-100"
  >
    <div
      class="bg-white w-full max-w-md rounded-2xl shadow-xl overflow-hidden border border-gray-100"
    >
      <!-- Header -->
      <div class="bg-indigo-600 p-6 text-center">
        <h1 class="text-2xl font-bold text-white">QR Code Generator</h1>
        <p class="text-indigo-200 text-sm mt-1">
          Buat kode QR kustom Anda secara instan
        </p>
      </div>

      <!-- Tabs Navigation -->
      <div class="flex border-b border-gray-200">
        <button
          onclick="switchTab('text')"
          id="tab-btn-text"
          class="flex-1 py-3 px-4 text-center text-sm font-semibold text-indigo-600 border-b-2 border-indigo-600 focus:outline-none transition-colors"
        >
          Teks / URL
        </button>
        <button
          onclick="switchTab('wa')"
          id="tab-btn-wa"
          class="flex-1 py-3 px-4 text-center text-sm font-semibold text-gray-500 hover:text-indigo-600 focus:outline-none transition-colors border-b-2 border-transparent"
        >
          WhatsApp
        </button>
      </div>

      <!-- Body -->
      <div class="p-6 space-y-6">
        <!-- Tab Content: Text/URL -->
        <div id="content-text" class="block">
          <label
            for="text-input"
            class="block text-sm font-medium text-gray-700 mb-2"
            >Teks atau URL</label
          >
          <input
            type="text"
            id="text-input"
            class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-200"
            placeholder="Contoh: https://google.com atau Halo Dunia"
            autocomplete="off"
          />
        </div>

        <!-- Tab Content: WhatsApp -->
        <div id="content-wa" class="hidden space-y-4">
          <div>
            <label
              for="wa-number"
              class="block text-sm font-medium text-gray-700 mb-2"
              >Nomor WhatsApp</label
            >
            <input
              type="tel"
              id="wa-number"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-200"
              placeholder="Contoh: 628123456789"
              autocomplete="off"
            />
            <p class="text-xs text-gray-500 mt-1">
              Gunakan kode negara (misal: 62 untuk Indonesia) tanpa tanda +.
            </p>
          </div>
          <div>
            <label
              for="wa-message"
              class="block text-sm font-medium text-gray-700 mb-2"
              >Pesan Otomatis</label
            >
            <textarea
              id="wa-message"
              rows="3"
              class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition duration-200"
              placeholder="Halo, saya ingin bertanya tentang produk Anda..."
            ></textarea>
          </div>
        </div>

        <!-- Color Options -->
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label
              for="color-dark"
              class="block text-sm font-medium text-gray-700 mb-2"
              >Warna Kode</label
            >
            <div
              class="flex items-center space-x-2 border border-gray-300 rounded-lg p-2 cursor-pointer hover:bg-gray-50 transition"
            >
              <input
                type="color"
                id="color-dark"
                value="#000000"
                class="w-8 h-8 rounded cursor-pointer border-none bg-transparent"
              />
              <span class="text-sm text-gray-500">Pilih</span>
            </div>
          </div>
          <div>
            <label
              for="color-light"
              class="block text-sm font-medium text-gray-700 mb-2"
              >Latar Belakang</label
            >
            <div
              class="flex items-center space-x-2 border border-gray-300 rounded-lg p-2 cursor-pointer hover:bg-gray-50 transition"
            >
              <input
                type="color"
                id="color-light"
                value="#ffffff"
                class="w-8 h-8 rounded cursor-pointer border-none bg-transparent"
              />
              <span class="text-sm text-gray-500">Pilih</span>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <button
          onclick="generateQR()"
          class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg shadow-lg hover:shadow-xl transition duration-300 transform hover:-translate-y-0.5 active:translate-y-0"
        >
          Buat QR Code
        </button>

        <!-- Output Area -->
        <div
          id="output-container"
          class="hidden flex-col items-center justify-center space-y-4 p-6 bg-gray-50 rounded-xl border border-gray-200 dashed"
        >
          <div id="qrcode" class="p-2 bg-white rounded-lg shadow-sm"></div>

          <div class="flex space-x-3 w-full">
            <button
              onclick="downloadQR()"
              class="flex-1 flex items-center justify-center px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium transition shadow-sm"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5 mr-2"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"
                />
              </svg>
              Unduh PNG
            </button>
            <button
              onclick="clearQR()"
              class="px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg font-medium transition"
            >
              Reset
            </button>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="bg-gray-50 px-6 py-4 text-center border-t border-gray-100">
        <p class="text-xs text-gray-400">&copy; 2024 Simple QR Generator</p>
      </div>
    </div>

    <!-- Notification Toast -->
    <div
      id="toast"
      class="fixed bottom-5 right-5 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 pointer-events-none"
    >
      Pesan notifikasi
    </div>

    <script>
      // Inisialisasi variabel
      let activeTab = "text"; // 'text' atau 'wa'

      const textInput = document.getElementById("text-input");
      const waNumberInput = document.getElementById("wa-number");
      const waMessageInput = document.getElementById("wa-message");

      const colorDarkInput = document.getElementById("color-dark");
      const colorLightInput = document.getElementById("color-light");
      const qrcodeContainer = document.getElementById("qrcode");
      const outputContainer = document.getElementById("output-container");
      let qrcodeObj = null;

      // Fungsi Ganti Tab
      function switchTab(tab) {
        activeTab = tab;
        const btnText = document.getElementById("tab-btn-text");
        const btnWa = document.getElementById("tab-btn-wa");
        const contentText = document.getElementById("content-text");
        const contentWa = document.getElementById("content-wa");

        if (tab === "text") {
          // Style Button
          btnText.classList.add("text-indigo-600", "border-indigo-600");
          btnText.classList.remove("text-gray-500", "border-transparent");
          btnWa.classList.add("text-gray-500", "border-transparent");
          btnWa.classList.remove("text-indigo-600", "border-indigo-600");

          // Show/Hide Content
          contentText.classList.remove("hidden");
          contentWa.classList.add("hidden");
        } else {
          // Style Button
          btnWa.classList.add("text-indigo-600", "border-indigo-600");
          btnWa.classList.remove("text-gray-500", "border-transparent");
          btnText.classList.add("text-gray-500", "border-transparent");
          btnText.classList.remove("text-indigo-600", "border-indigo-600");

          // Show/Hide Content
          contentWa.classList.remove("hidden");
          contentText.classList.add("hidden");
        }

        // Sembunyikan output saat ganti tab agar user tidak bingung
        outputContainer.classList.add("hidden");
        outputContainer.classList.remove("flex");
      }

      // Fungsi membuat QR Code
      function generateQR() {
        let finalText = "";

        if (activeTab === "text") {
          finalText = textInput.value.trim();
          if (!finalText) {
            showToast("⚠️ Mohon masukkan teks atau URL!", true);
            textInput.focus();
            return;
          }
        } else if (activeTab === "wa") {
          let phone = waNumberInput.value.replace(/[^0-9]/g, ""); // Ambil angka saja
          const message = waMessageInput.value.trim();

          if (!phone) {
            showToast("⚠️ Mohon masukkan nomor WhatsApp!", true);
            waNumberInput.focus();
            return;
          }

          // Normalisasi nomor (jika user input 08..., ubah jadi 628...)
          if (phone.startsWith("0")) {
            phone = "62" + phone.substring(1);
          }

          // Format link WhatsApp API
          // encodeURIComponent agar spasi dan enter terbaca dengan benar di URL
          finalText = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
        }

        // Bersihkan QR code lama
        qrcodeContainer.innerHTML = "";
        outputContainer.classList.remove("hidden");
        outputContainer.classList.add("flex");

        // Generate QR Code baru
        try {
          qrcodeObj = new QRCode(qrcodeContainer, {
            text: finalText,
            width: 200,
            height: 200,
            colorDark: colorDarkInput.value,
            colorLight: colorLightInput.value,
            correctLevel: QRCode.CorrectLevel.H,
          });

          showToast("✅ QR Code berhasil dibuat!");

          // Scroll ke hasil
          setTimeout(() => {
            outputContainer.scrollIntoView({
              behavior: "smooth",
              block: "nearest",
            });
          }, 100);
        } catch (error) {
          console.error(error);
          showToast("❌ Terjadi kesalahan saat membuat QR Code.", true);
        }
      }

      // Fungsi Download
      function downloadQR() {
        // Tunggu sebentar agar gambar ter-render sepenuhnya di DOM
        setTimeout(() => {
          const img = qrcodeContainer.querySelector("img");

          if (img && img.src) {
            const link = document.createElement("a");
            link.href = img.src;
            link.download = `qrcode-${activeTab}-${Date.now()}.png`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            showToast("⬇️ Gambar sedang diunduh...");
          } else {
            // Fallback jika library merender canvas (browser tertentu)
            const canvas = qrcodeContainer.querySelector("canvas");
            if (canvas) {
              const link = document.createElement("a");
              link.href = canvas.toDataURL("image/png");
              link.download = `qrcode-${activeTab}-${Date.now()}.png`;
              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
              showToast("⬇️ Gambar sedang diunduh...");
            } else {
              showToast("⚠️ Gambar belum siap, coba lagi.", true);
            }
          }
        }, 100);
      }

      // Fungsi Reset
      function clearQR() {
        if (activeTab === "text") {
          textInput.value = "";
          textInput.focus();
        } else {
          waNumberInput.value = "";
          waMessageInput.value = "";
          waNumberInput.focus();
        }

        qrcodeContainer.innerHTML = "";
        outputContainer.classList.add("hidden");
        outputContainer.classList.remove("flex");
      }

      // Helper: Menampilkan notifikasi toast
      function showToast(message, isError = false) {
        const toast = document.getElementById("toast");
        toast.textContent = message;

        if (isError) {
          toast.classList.remove("bg-gray-800");
          toast.classList.add("bg-red-500");
        } else {
          toast.classList.add("bg-gray-800");
          toast.classList.remove("bg-red-500");
        }

        toast.classList.remove("translate-y-20", "opacity-0");

        setTimeout(() => {
          toast.classList.add("translate-y-20", "opacity-0");
        }, 3000);
      }

      // Event Listeners agar bisa tekan Enter
      textInput.addEventListener("keypress", function (event) {
        if (event.key === "Enter") {
          event.preventDefault();
          generateQR();
        }
      });

      // Enter untuk WA (tapi tidak untuk textarea pesan agar bisa enter baris baru)
      waNumberInput.addEventListener("keypress", function (event) {
        if (event.key === "Enter") {
          event.preventDefault();
          generateQR();
        }
      });
    </script>
  </body>
</html>
